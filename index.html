<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<title>Моя игра</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
  :root{--green:#39ff14;--red:#ff2e2e}
  body{
    margin:0;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#222;
    font-family:monospace;
    overflow:hidden;
  }
  .grid{
    z-index:2;
    display:grid;
    grid-template-columns:1fr 1fr;
    grid-template-rows:1fr 1fr;
    gap:20px;
  }
  .grid img{
    width:250px;
    height:250px;
    cursor:pointer;
    border:2px solid #fff;
    object-fit:cover;
    background:#000;
  }
  video.main {
    position:fixed;
    top:5%;
    left:10%;
    width:80%;
    height:auto;
    z-index:1; /* ниже grid, но мы будем скрывать grid при старте видео */
    background:black;
  }

  /* overlay / консоль / вопросы */
  .overlay{
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    background:rgba(0,0,0,0.95);
    z-index:1100;
  }
  .console{
    width:90%;
    max-width:900px;
    height:70%;
    padding:20px;
    box-sizing:border-box;
    overflow:auto;
    font-family:'Press Start 2P',monospace;
    color:#fff;
    word-break:break-word;
  }
  .line{ white-space:pre; font-size:16px; line-height:1.5; }
  .green{ color:var(--green); }
  .white{ color:#fff; }

  .question{
    font-family:'Press Start 2P',monospace;
    font-size:40px;
    margin-bottom:20px;
    text-align:center;
    color:#fff;
  }
  .buttons{ display:flex; gap:40px; align-items:center; justify-content:center; }

  .btn{
    font-family:'Press Start 2P',monospace;
    font-size:20px;
    padding:18px 40px;
    border-radius:18px;
    border:none;
    cursor:pointer;
    transition:transform .12s;
  }
  .btn:active{ transform:scale(.98); }
  .btn.green{ background:var(--green); color:#000; }
  .btn.red{ background:var(--red); color:#000; position:relative; }

  /* trail effect for fleeing button */
  .trail{
    position:fixed;
    pointer-events:none;
    opacity:.6;
    filter:blur(0.5px);
    mix-blend-mode:screen;
    animation:fadeTrail 600ms linear forwards;
    z-index:1200;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  @keyframes fadeTrail{
    from{ transform:translateY(0); opacity:.6; }
    to{ transform:translateY(-10px); opacity:0; }
  }

  /* big insult style */
  .big-insult{
    font-family:'Press Start 2P',monospace;
    color:#ff4d4d;
    font-size:28px;
    text-align:center;
    z-index:1200;
  }

  /* fallback black screen */
  .black-screen{
    position:fixed; inset:0; background:#000; display:flex; align-items:center; justify-content:center; z-index:2000;
  }
  .black-screen .text{ font-family:'Press Start 2P',monospace; color:#ff4d4d; font-size:36px; text-align:center; }
</style>
</head>
<body>
  <div class="grid" id="grid">
    <img src="PENIS1.png" onclick="handleClick(this,0)">
    <img src="PENIS2.png" onclick="handleClick(this,1)">
    <img src="PENIS3.png" onclick="handleClick(this,2)">
    <img src="PENIS4.png" onclick="handleClick(this,3)">
  </div>

  <!-- main video (ёжики) inserted dynamically -->
  <audio id="lohAudio" src="yuarick_loh.mp3" preload="auto"></audio>

<script>
/* ========== Переменные ========== */
const clicked = [false,false,false,false];
let videoOpened = false;
let mainVideo = null;
let noClickCount = 0;

/* ---------- Утилиты ---------- */
function createOverlay() {
  let ov = document.querySelector('.overlay');
  if(ov) return ov;
  ov = document.createElement('div');
  ov.className = 'overlay';
  document.body.appendChild(ov);
  return ov;
}
function removeOverlay(){
  const ov = document.querySelector('.overlay');
  if(ov) ov.remove();
}
function writeConsoleLine(consoleBox, text, color='white', perChar=30, cb){
  const el = document.createElement('div');
  el.className = 'line';
  if(color === 'green') el.style.color = 'var(--green)';
  else if(color === 'red') el.style.color = 'red';
  else el.style.color = '#fff';
  consoleBox.appendChild(el);
  let i=0;
  const t = setInterval(()=>{
    if(i < text.length) el.textContent += text[i++];
    consoleBox.scrollTop = consoleBox.scrollHeight;
    if(i>=text.length){ clearInterval(t); cb && cb(); }
  }, perChar);
}

/* ========== Обработчики основного экрана ========== */
function handleClick(imgEl, idx){
  // показываем alert при любом клике (вернули)
  alert("(ERROR_my_game1= 0) ЯРИК СУКА ВЕРНИ БЛЯДЬ 3 ГРИВНЫ НАХУЙ!!!");

  // эффект замены на pezniz
  const original = imgEl.src;
  imgEl.src = 'pezniz.png';
  setTimeout(()=>{ imgEl.src = original }, 500);

  clicked[idx] = true;

  if(!videoOpened && clicked.every(v=>v)){
    videoOpened = true;
    // спрячем grid (кнопки)
    const grid = document.getElementById('grid');
    if(grid) grid.style.display = 'none';

    // создаём и запускаем видео (ёжики)
    mainVideo = document.createElement('video');
    mainVideo.className = 'main';
    mainVideo.src = 'ёжики.mp4';
    mainVideo.autoplay = true;
    mainVideo.controls = true;
    mainVideo.playsInline = true;
    document.body.appendChild(mainVideo);

    // через 12 секунд показать консоль (ты просил 12 сек после включения видео)
    setTimeout(()=>{
      try{ mainVideo.pause(); } catch(e){}
      startFakeConsole();
    }, 12000);
  }
}

/* ========== Консоль и печать ========== */
function startFakeConsole(){
  const ov = createOverlay();
  ov.innerHTML = '';
  const consoleBox = document.createElement('div');
  consoleBox.className = 'console';
  ov.appendChild(consoleBox);

  const lines = [
    {text:'download file "cocal"', color:'white'},
    {text:'done', color:'green'},
    {text:'Checking user profile "sdfdeedef2"', color:'white'},
    {text:'done', color:'green'},
    {text:'checking repository "E:\\js_game 1"', color:'white'},
    {text:'done', color:'green'},
    {text:'Checking files in repository "E:\\js_game 1"', color:'white'},
    {text:'done', color:'green'},
    {text:'found files:', color:'green'},
    {text:'"index.html", "PENIS1.png", "PENIS2.png", "PENIS3.png"', color:'green'},
    {text:'"PENIS4.png", "pezniz.png", "ёжики.mp4", "yuarick.jpg"', color:'green'},
    {text:'"de_babki.mp4", "{", "git", "yuarick_loh.mp3"', color:'green'}
    {text:'updating "index.html"', color:'white'},
    {text:'PERCENT_SEQUENCE', color:'green'},
    {text:'done', color:'green'},
    {text:'opening "index.html"', color:'white'},
    {text:'done', color:'green'}
  ];

  let cur=0;
  function next(){
    if(cur>=lines.length){
      setTimeout(()=> showSosalsQuestion('both'), 300);
      return;
    }
    const info = lines[cur++];
    if(info.text === 'PERCENT_SEQUENCE'){
      const percentEl = document.createElement('div');
      percentEl.className = 'line';
      percentEl.style.color = 'var(--green)';
      consoleBox.appendChild(percentEl);
      runPercent(percentEl, ()=> setTimeout(next,300));
    } else {
      writeConsoleLine(consoleBox, info.text, info.color==='green'?'green':'white', 40, ()=> setTimeout(next,300));
    }
  }
  next();
}

function runPercent(el, cb){
  let p=1;
  el.textContent = p + '%';
  const it = setInterval(()=>{
    p++;
    el.textContent = p + '%';
    if(p>=100){ clearInterval(it); cb && cb(); }
  }, 20);
}

/* ========== Вопрос "СОСАЛ?" (mode: 'both' или 'yesOnly') ========== */
function showSosalsQuestion(mode='both'){
  const ov = createOverlay();
  ov.innerHTML = ''; // очистили консоль/оверлей

  const question = document.createElement('div');
  question.className = 'question';
  question.textContent = 'СОСАЛ?';
  ov.appendChild(question);

  const buttonsWrap = document.createElement('div');
  buttonsWrap.className = 'buttons';
  ov.appendChild(buttonsWrap);

  const yesBtn = document.createElement('button');
  yesBtn.className = 'btn green';
  yesBtn.textContent = 'ДА';

  const noBtn = document.createElement('button');
  noBtn.className = 'btn red';
  noBtn.textContent = 'НЕТ';

  // если режим yesOnly — показываем только кнопку ДА
  if(mode === 'yesOnly'){
    buttonsWrap.appendChild(yesBtn);
    // добавляем обработчик ДА
    yesBtn.addEventListener('click', ()=> {
      // скачиваем фото и переходим к оплате
      const a = document.createElement('a');
      a.href = 'yuarick.jpg';
      a.download = 'yuarick.jpg';
      document.body.appendChild(a);
      a.click();
      a.remove();
      yesBtn.style.display='none';
      setTimeout(()=> showPaymentQuestion(), 300);
    });
    return;
  }

  // mode === 'both': поведение кнопки НЕТ
  noBtn.addEventListener('click', ()=>{
    noClickCount++;
    // звук с 5-го клика
    if(noClickCount >= 5){
      try{ const a = document.getElementById('lohAudio'); a.currentTime = 0; a.play(); }catch(e){}
    }

    // создаём след (клонируем кнопку и анимируем)
    const rect = noBtn.getBoundingClientRect();
    const trail = noBtn.cloneNode(true);
    trail.className = 'trail';
    trail.style.left = (rect.left) + 'px';
    trail.style.top = (rect.top) + 'px';
    trail.style.width = rect.width + 'px';
    trail.style.height = rect.height + 'px';
    trail.style.borderRadius = getComputedStyle(noBtn).borderRadius;
    trail.style.fontFamily = 'Press Start 2P,monospace';
    trail.style.fontSize = getComputedStyle(noBtn).fontSize;
    document.body.appendChild(trail);
    setTimeout(()=> trail.remove(), 700);

    // телепортируем NO кнопку
    const left = Math.random() * Math.max(0, window.innerWidth - 300);
    const top  = Math.random() * Math.max(0, window.innerHeight - 150);
    noBtn.style.position = 'absolute';
    noBtn.style.left = left + 'px';
    noBtn.style.top = top + 'px';

    // на 15 клике — кнопка "НЕТ" скрывается (только она), показываем надпись,
    // через 3 секунды возвращаем вопрос но только с кнопкой ДА
    if(noClickCount >= 15){
      noBtn.style.display = 'none'; // скрываем только кнопку НЕТ
      const insult = document.createElement('div');
      insult.className = 'big-insult';
      insult.textContent = 'ДА ЛАДНО, ТЫ ЛОХ КОТОРЫЙ СОСАЛ!!!';
      document.body.appendChild(insult);

      // через 3 секунды убираем надпись и показываем вопрос с одной кнопкой ДА
      setTimeout(()=>{
        try{ insult.remove(); }catch(e){}
        showSosalsQuestion('yesOnly');
      }, 3000);
    }
  });

  // да — скачивает yuarick.jpg и далее идёт оплата
  yesBtn.addEventListener('click', ()=>{
    const a = document.createElement('a');
    a.href = 'yuarick.jpg';
    a.download = 'yuarick.jpg';
    document.body.appendChild(a);
    a.click();
    a.remove();

    yesBtn.style.display='none';
    noBtn.style.display='none';
    setTimeout(()=> showPaymentQuestion(), 300);
  });

  buttonsWrap.appendChild(noBtn);
  buttonsWrap.appendChild(yesBtn);
}

/* ========== Вопрос об оплате (идея 2) ========== */
function showPaymentQuestion(){
  const ov = createOverlay();
  ov.innerHTML = '';

  const question = document.createElement('div');
  question.className = 'question';
  question.textContent = 'Оплатишь 3 гривны?';
  ov.appendChild(question);

  const buttonsWrap = document.createElement('div');
  buttonsWrap.className = 'buttons';
  ov.appendChild(buttonsWrap);

  const noPayBtn = document.createElement('button');
  noPayBtn.className = 'btn red';
  noPayBtn.textContent = 'Не платить';

  const payBtn = document.createElement('button');
  payBtn.className = 'btn green';
  payBtn.textContent = 'Оплатить';

  // порядок: сначала noPayBtn (слева), затем payBtn (справа)
  buttonsWrap.appendChild(noPayBtn);
  buttonsWrap.appendChild(payBtn);

  noPayBtn.addEventListener('click', ()=>{
    const ovConsole = createOverlay();
    ovConsole.innerHTML = '';
    const consoleBox = document.createElement('div');
    consoleBox.className = 'console';
    // делаем текст красным и с переносом
    consoleBox.style.color = 'red';
    consoleBox.style.wordBreak = 'break-word';
    consoleBox.style.textAlign = 'center';
    consoleBox.style.fontSize = '18px';
    ovConsole.appendChild(consoleBox);

    const time = new Date().toLocaleTimeString();
    writeConsoleLine(consoleBox, `3 гривны из кредитки твоей мамы были перенесены 
    пользователем sdfdeedef2 в ${time}`, 'red', 20, ()=>{
      setTimeout(()=> playDeBabkiVideo(), 1500);
    });
  });

  payBtn.addEventListener('click', ()=>{
    const ovConsole = createOverlay();
    ovConsole.innerHTML = '';
    const consoleBox = document.createElement('div');
    consoleBox.className = 'console';
    ovConsole.appendChild(consoleBox);

    writeConsoleLine(consoleBox, 'Бабки давай, а то у твоей мамы сворую', 'green', 20, ()=>{
      setTimeout(()=> playDeBabkiVideo(), 1500);
    });
  });
}

/* ========== Идея 3 — финальное видео (de_babki.mp4) и закрытие вкладки / fallback ========== */
function playDeBabkiVideo(){
  const ov = createOverlay();
  ov.innerHTML = '';
  const video = document.createElement('video');
  video.src = 'de_babki.mp4';
  video.autoplay = true;
  video.controls = false;
  video.style.width = '90%';
  video.style.maxWidth = '1000px';
  ov.appendChild(video);

  // когда видео закончится — сразу пробуем закрыть вкладку (после полного проигрыша)
  video.addEventListener('ended', ()=>{
    setTimeout(()=>{
      try{
        window.close();
        // если window.close() не закрыл вкладку — показываем fallback через небольшой таймаут
        setTimeout(()=>{ showBlackFallback(); }, 500);
      }catch(e){
        showBlackFallback();
      }
    }, 0);
  });

  // safety: попытка автозапуска, если заблокировано
  setTimeout(()=>{
    if(video.paused){
      try{ video.play(); }catch(e){}
    }
  }, 800);
}

/* показываем черный экран с надписью "БАБКИ ДАЙ" */
function showBlackFallback(){
  removeOverlay();
  const black = document.createElement('div');
  black.className = 'black-screen';
  black.innerHTML = `<div class="text">БАБКИ ДАЙ</div>`;
  document.body.appendChild(black);
}

/* ========== Инициализация ========== */
/* Логика запускается по кликам — инициализация не нужна */
</script>
</body>
</html>
